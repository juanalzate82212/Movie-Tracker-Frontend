
<div *ngIf="loading" class="loading">Cargando...</div>

<div class="movie-detail" *ngIf="movie">
  <div class="poster">
    <img
      [src]="posterUrl"
      [alt]="movie.title" />
  </div>

  <div class="info">
    <h1>
      {{ movie.title }}

    </h1>

    <p class="meta">
      <span *ngIf="movie.director">üé¨ {{ movie.director }}</span>
      <span *ngIf="movie.releaseDate"> ‚Ä¢ {{ movie.releaseDate | date:'yyyy'
        }}</span>
      <span *ngIf="movie.runtime"> ‚Ä¢ ‚è± {{ movie.runtime }} min</span>
    </p>

    <div class="genres">
      <span class="genre" *ngFor="let genre of movie.genres">
        {{ genre }}
      </span>
    </div>

    <p class="overview">
      {{ movie.overview }}
    </p>

    <button class="add-btn" (click)="openAddModal()">
      + Agregar a mis pel√≠culas
    </button>

    <p *ngIf="successMessage" class="success-msg">
      ‚úÖ {{ successMessage }}
    </p>

    <p *ngIf="errorMessage" class="error-msg">
      ‚ùå {{ errorMessage }}
    </p>

    <button class="favorite-btn" [class.active]="isFavorite" [disabled]="favoriteLoading" (click)="toggleFavorite()">
      <span *ngIf="!isFavorite">‚≠ê Agregar a favoritas</span>
      <span *ngIf="isFavorite">‚≠ê Quitar de favoritas</span>
    </button>

    <p class="error" *ngIf="favoriteError">{{ favoriteError }}</p>
  </div>

  <div *ngIf="showAddForm" class="add-box">
    <div class="add-form-card">

      <h3>Agregar pel√≠cula</h3>

      <label>
        Estado
        <select [(ngModel)]="status">
          <option value="pending">Pendiente</option>
          <option value="watched">Vista</option>
        </select>
      </label>

      <label *ngIf="status === 'watched'">
        Rating (opcional)
        <input
          type="number"
          min="1"
          max="10"
          [(ngModel)]="rating"
          placeholder="1 - 10" />
      </label>

      <div class="actions">
        <button class="save-btn"
          [disabled]="status === 'watched' && (!rating || rating < 1 || rating > 10)"
          (click)="addMovie()">Guardar</button>
        <button class="cancel-btn" (click)="closeAddModal()">Cancelar</button>
      </div>

    </div>
  </div>

</div>
